[Главная](../index) → Начало работы → Проверка обновлений с Forge<br>
<small>[← Назад](Structuring_Your_Mod "Начало работы: Структура Вашей модификации") | [Далее →](Debug_Profiler "Начало работы: Отладочный профилировщик")</small>

---

- [**Проверка обновлений с Forge**](#Forge_Update_Checker)
  + [**Начало работы**](#Getting_Started)
  + [**Формат JSON-файла обновлений**](#Update_JSON_format)
  + [**Получение результатов проверки обновлений**](#Retrieving_Update_Check_Results)

---

# <a name="Forge_Update_Checker"></a>Проверка обновлений с Forge
Forge предоставляет очень лёгкий встроенный фреймворк для проверки обновлений. Всё, что он делает, — это проверка на наличие обновлений. Если для какой-либо модификации доступна новая версия, фреймворк добавляет на кнопку «Mods» («Моды») в главном меню и в список модов мигающую иконку, а также перечень нововведений. Автоматического скачивания обновления *не происходит*.

## <a name="Getting_Started"></a>Начало работы
Первое, что Вам следует сделать, — определить свойство `updateJSONURL` в файле `mods.toml`. Значением этого параметра должен быть URL-адрес JSON-файла обновлений. Этот файл может быть размещён на Вашем собственном веб-сайте, на GitHub или где бы то ни было ещё — главное, чтобы он был доступен для всех, кто использует Вашу модификацию.

## <a name="Update_JSON_format"></a>Формат JSON-файла обновлений
Сам JSON-файл имеет довольно простой формат, выглядящий следующим образом:

```json
{
  "homepage": "<ссылка на сайт, где можно скачать Вашу модификацию>",
  "<версия Minecraft>": {
    "<версия модификации>": "<список нововведений и изменений>", 
    // Список всех версий Вашей модификации для данной версии Minecraft с их нововведениями
    ...
  },
  ...
  "promos": {
    "<версия Minecraft>-latest": "<версия модификации>",
    // Определяет самую последнюю версию модификации для данной версии Minecraft
    "<версия Minecraft>-recommended": "<версия модификации>",
    // Определяет последнюю стабильную версию модификации для данной версии Minecraft
    ...
  }
}
```

В этом коде довольно несложно разобраться, но вот несколько комментариев:
- Ссылка `homepage` будет показываться пользователю, когда его версия модификации станет устаревшей.
- Forge использует специальный алгоритм, чтобы определить, является ли одна строка с номером версии «новее» другой. Большинство схем именования версий должны поддерживаться этим алгоритмом, но если у Вас есть сомнения по поводу поддержки Вашей схемы, ознакомьтесь с классом `ComparableVersion`. Настоятельно рекомендуется следовать «[Semantic Versioning](https://semver.org/lang/ru)».
- Список нововведений может быть разделён на строки символом `\n`. Некоторые предпочитают указывать здесь краткий список со ссылкой на сайт, где представлен полный перечень.
- Ручной ввод данных может оказаться утомительным. Вы можете настроить Ваш `build.gradle` на автоматическое обновление этого файла при сборке релизной версии, так как Groovy поддерживает формат JSON. Оставим это в качестве упражнения для читателя.
- Вот некоторые примеры этого файла: [Nocubes](https://cadiboo.github.io/projects/nocubes/update.json), [Corail Tombstone](https://github.com/Corail31/tombstone_lite/blob/master/update.json) и [Chisels & Bits 2](https://github.com/Corail31/tombstone_lite/blob/master/update.json).

## <a name="Retrieving_Update_Check_Results">Получение результатов проверки обновлений
Вы можете получить результаты проверки обновлений Forge Update Checker с помощью `VersionChecker.getResult(ModInfo)`. У возвращаемого этим методом объекта имеется поле `status`, содержащее информацию о статусе проверки. Это поле может принимать значения `FAILED` (не удалось подключиться к указанному URL), `UP_TO_DATE` (текущая версия совпадает с последней стабильной или является более новой), `OUTDATED` (обнаружена более новая стабильная версия), `BETA_OUTDATED` (обнаружена более новая, но нестабильная версия) или `BETA` (текущая версия совпадает с последней нестабильной или является более новой). Статус будет иметь значение `PENDING`, если проверка ещё не завершена; в этом случае Вам следует повторить попытку немного позднее. Во всех остальных случаях возвращаемый объект будет также содержать номер найденной версии и список изменений из файла `update.json`. Чтобы передать в эту функцию `ModInfo`, Вам понадобится получить свой `ModContainer` (и использовать `ModContainer#getModInfo()`). Это можно сделать с помощью `ModLoadingContext.get().getActiveContainer()` внутри конструктора, `ModList.get().getModContainerById(<id модификации>)`, `ModList.get().getModContainerByObject(<экземпляр модификации>)` или с помощью `ModContainer` любой другой модификации, используя `ModList.get().getModContainerById(<id модификации>)`.

---

<small>[← Назад](Structuring_Your_Mod "Начало работы: Структура Вашей модификации") | [Далее →](Debug_Profiler "Начало работы: Отладочный профилировщик")</small>